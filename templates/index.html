<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ONE KEF Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #f5f5f5; 
        }
        .chatbot-card {
            max-width: 480px; margin: 40px auto; padding: 20px;
            background: white; border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-top: 8px solid #d71920;
        }
        .chatbot-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .chatbot-header img {
            max-width: 120px;
        }
        .chatbot-header h2 {
            margin: 10px 0 0; font-size: 20px;
        }
        .btn-group { 
            margin: 10px 0; 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
            justify-content: center;
        }
        .btn {
            flex: 1 1 45%; 
            padding: 10px;
            background: linear-gradient(45deg, #d71920, #003366);
            color: white; border: none; border-radius: 10px;
            cursor: pointer; font-size: 14px;
            transition: background 0.3s;
        }
        .btn:hover { 
            background: linear-gradient(45deg, #b5171a, #002244); 
        }
        .answer-box {
            margin-top: 15px; padding: 12px;
            border: 1px solid #ccc; border-radius: 10px;
            background: #fafafa; white-space: pre-line;
            font-size: 14px; line-height: 1.4em;
            max-height: 120px; overflow-y: auto;   /* smaller size with scroll */
        }
        .teacher-input {
            margin-top: 20px;
        }
        .teacher-input textarea {
            width: 100%; height: 80px;
            padding: 10px; border-radius: 10px;
            border: 1px solid #ccc; resize: none;
            font-size: 14px; font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div class="chatbot-card">
        <div class="chatbot-header">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="KEF Logo">
            <h2>ONE KEF Assistant</h2>
            <small>Powered by Kotak Education Foundation</small>
        </div>

        <h4>Step 1: Select a Category</h4>
        <div id="categories" class="btn-group"></div>

        <h4>Step 2: Select a Question</h4>
        <div id="questions" class="btn-group"></div>

        <h4>Answer:</h4>
        <div id="answer" class="answer-box">Please select a question above.</div>

        <div class="teacher-input">
            <h4>Additional Notes (Teacher Input):</h4>
            <textarea placeholder="Write here..."></textarea>
        </div>
    </div>

    <script>
        const data = {{ qa_data|tojson }};

        const categoriesDiv = document.getElementById("categories");
        const questionsDiv = document.getElementById("questions");
        const answerDiv = document.getElementById("answer");

        // Render category buttons
        Object.keys(data).forEach(category => {
            const btn = document.createElement("button");
            btn.className = "btn";
            btn.innerText = category;
            btn.onclick = () => loadQuestions(category);
            categoriesDiv.appendChild(btn);
        });

        function loadQuestions(category) {
            questionsDiv.innerHTML = "";
            answerDiv.innerText = "Please select a question.";
            const questions = Object.keys(data[category]);
            questions.forEach(q => {
                const btn = document.createElement("button");
                btn.className = "btn";
                btn.innerText = q;
                btn.onclick = () => showAnswer(category, q);
                questionsDiv.appendChild(btn);
            });
        }

        function showAnswer(category, question) {
            answerDiv.innerText = data[category][question];
        }
    </script>
</body>
</html>
